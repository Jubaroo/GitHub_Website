<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JSON to XML Converter</title>
    <link rel="stylesheet" href="../../styles/web-styles.css" />
    <style>
      .description {
        color: #ffffff;
        font-size: 1.2em;
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>JSON to XML Converter</h1>
      <nav>
        <a href="../../index.html">Home</a>
        <div class="dropdown">
          <a href="#">Audio Tools</a>
          <div class="dropdown-content">
            <a href="../audio/audio-converter.html">Audio Converter</a>
          </div>
        </div>
        <div class="dropdown">
          <a href="#">Video Tools</a>
          <div class="dropdown-content">
            <a href="../video/video-converter.html">Video Converter</a>
          </div>
        </div>
        <div class="dropdown">
          <a href="#">Image Tools</a>
          <div class="dropdown-content">
            <a href="../images/image-extraction.html">PDF Image Extraction</a>
            <a href="../images/background-removal.html">Background Removal</a>
            <a href="../images/image-converter.html">Image Converter</a>
          </div>
        </div>
        <div class="dropdown">
          <a href="#">Web Tools</a>
          <div class="dropdown-content">
            <a href="html-validator.html">HTML/CSS Validator</a>
            <a href="json-formatter.html">JSON Formatter</a>
            <a href="regex-tester.html">Regex Tester</a>
            <a href="json-xml-converter.html">JSON-XML Converter</a>
            <a href="code-beautifier.html">Code Beautifier</a>
            <a href="markdown-previewer.html">Markdown Previewer</a>
            <a href="css-minifier.html">CSS Minifier</a>
          </div>
        </div>
        <div class="dropdown">
          <a href="#">Other Tools</a>
          <div class="dropdown-content">
            <a href="../misc/password-generator.html">Password Generator</a>
            <a href="../misc/finance-tracker.html">Finance Tracker</a>
            <a href="../misc/llm.html">Web-Based LLM</a>
          </div>
        </div>
      </nav>
    </header>
    <div class="container">
      <h2>Convert JSON to XML</h2>
      <p class="description">
        Quickly convert your JSON data to XML format. Paste your JSON into the
        input box below and click "Convert to XML" to get the XML output. This
        tool simplifies data interchange between systems that use different data
        formats.
      </p>
      <textarea id="json-input" placeholder="Paste your JSON here"></textarea>
      <div class="button-group">
        <button onclick="convertJSONtoXML()">Convert to XML</button>
        <button onclick="copyToClipboard()">Copy to Clipboard</button>
      </div>
      <pre id="xml-output"></pre>
      <div id="copy-message"></div>
    </div>
    <footer>
      <p>&copy; 2024 Jarrod's Website. All rights reserved.</p>
    </footer>
    <script>
      // Define a variable to store the timeout ID
      let copyMessageTimeout;

      function convertJSONtoXML() {
        const jsonInput = document.getElementById("json-input").value.trim();
        const notification = document.getElementById("copy-message");

        if (!jsonInput) {
          document.getElementById("xml-output").textContent =
            "No JSON input provided.";
          notification.textContent = "";
          return;
        }

        try {
          const jsonObj = JSON.parse(jsonInput);
          const xmlOutput = jsonToXml(jsonObj);
          document.getElementById("xml-output").textContent = xmlOutput;
          notification.textContent = ""; // Clear previous message
        } catch (error) {
          document.getElementById("xml-output").textContent =
            "Invalid JSON input.";
          notification.textContent = ""; // Clear previous message
        }
      }

      function jsonToXml(obj, rootElement = "root") {
        let xml = `<${rootElement}>`;
        for (const key in obj) {
          if (Array.isArray(obj[key])) {
            for (const item of obj[key]) {
              xml += jsonToXml(item, key);
            }
          } else if (typeof obj[key] === "object") {
            xml += jsonToXml(obj[key], key);
          } else {
            xml += `<${key}>${obj[key]}</${key}>`;
          }
        }
        xml += `</${rootElement}>`;
        return xml;
      }

      function copyToClipboard() {
        const xmlOutput = document.getElementById("xml-output").textContent;
        const notification = document.getElementById("copy-message");

        if (
          xmlOutput.trim() === "" ||
          xmlOutput === "Invalid JSON input." ||
          xmlOutput === "No JSON input provided."
        ) {
          // Show an error message if there's nothing to copy or the JSON is invalid
          notification.textContent = "Nothing to copy!";
          notification.style.color = "red";
        } else {
          // Proceed with copying
          navigator.clipboard
            .writeText(xmlOutput)
            .then(() => {
              // Show success message
              notification.textContent = "Copied to clipboard!";
              notification.style.color = "green";
            })
            .catch((err) => {
              // Show failure message
              notification.textContent = "Failed to copy.";
              notification.style.color = "red";
            });
        }

        // Clear the previous timeout and set a new one
        clearTimeout(copyMessageTimeout);
        copyMessageTimeout = setTimeout(() => {
          notification.textContent = "";
        }, 3000);
      }
    </script>
  </body>
</html>
